<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>DocuSmart - Multimodal Document Abstraction</title>
  <style>
    * { box-sizing: border-box; scroll-behavior: smooth; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      background-color: #f4f6fb;
      color: #2c3e50;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    header {
      background-color: #34495e;
      color: #ecf0f1;
      padding: 25px 40px;
      text-align: center;
      font-size: 30px;
      font-weight: bold;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .intro-section {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 60px 40px;
      background-color: #ecf9f1;
      flex-wrap: wrap;
    }
    .intro-text { max-width: 50%; }
    .intro-text h2 { font-size: 38px; margin-bottom: 20px; color: #1abc9c; }
    .intro-text p { font-size: 18px; margin-bottom: 25px; color: #333; }
    .intro-text a {
      display: inline-block;
      padding: 12px 24px;
      background-color: #1abc9c;
      color: white;
      text-decoration: none;
      border-radius: 6px;
      font-weight: bold;
    }
    .intro-text a:hover { background-color: #148f77; }
    .intro-image img { max-width: 400px; border-radius: 8px; }
    .upload-section {
      padding: 50px 20px;
      background-color: #ffffff;
      text-align: center;
      flex-grow: 1;
    }
    input[type="file"] { margin-top: 15px; padding: 8px; font-size: 15px; }
    button {
      margin-top: 15px;
      padding: 10px 20px;
      background-color: #1abc9c;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
    }
    button:hover { background-color: #16a085; }
    #result {
      margin-top: 20px;
      margin-bottom: 70px;
      padding: 20px;
      background-color: #f9f9f9;
      border: 1px solid #ccc;
    }
    .feedback-btn {
      margin-top: 10px;
      padding: 10px 20px;
      background-color: #2c3e50;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 15px;
      cursor: pointer;
      margin-right: 10px;
    }
    .feedback-btn:hover { background-color: #1a252f; }
    footer {
      background-color: #2c3e50;
      color: white;
      text-align: center;
      padding: 15px;
      font-size: 14px;
      margin-top: auto;
    }
    .modal {
      display: none;
      position: fixed;
      z-index: 99;
      left: 0; top: 0; width: 100%; height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
    }
    .modal-content {
      background-color: #fff;
      margin: 10% auto;
      padding: 20px;
      border-radius: 10px;
      width: 90%;
      max-width: 500px;
    }
    .close {
      float: right;
      font-size: 22px;
      font-weight: bold;
      cursor: pointer;
    }
    #celebrationOverlay {
    display: none;
    position: fixed;
    inset: 0;
    z-index: 9999;
    background: rgba(50, 8, 202, 0.9);
    pointer-events: none;
  }

  .butterfly {
    position: absolute;
    width: 60px;
    height: 60px;
    background-size: cover;
    animation: fly 4s ease-in-out infinite;
    opacity: 0.8;
  }

  @keyframes fly {
    0% { transform: translateY(0) rotate(0deg); }
    50% { transform: translateY(-80px) rotate(180deg); }
    100% { transform: translateY(0) rotate(360deg); }
  }

  .confetti-piece {
    position: absolute;
    width: 12px;
    height: 12px;
    background-color: rgb(235, 13, 13);
    animation: fall 5s ease-out;
    opacity: 0.7;
    border-radius: 3px;
  }

  @keyframes fall {
    0% {
      transform: translateY(-20px) rotate(0deg);
      opacity: 1;
    }
    100% {
      transform: translateY(400px) rotate(720deg);
      opacity: 0;
    }
  }

  .celebration-message {
    position: absolute;
    top: 40%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 2rem;
    font-weight: bold;
    background: linear-gradient(45deg, #ff66cc, #66ccff, #ffff66, #99ff99);
    padding: 20px 40px;
    border-radius: 20px;
    color: #222;
    animation: pulse 1s ease-in-out infinite;
    z-index: 10000;
  }

  @keyframes pulse {
    0% { transform: scale(1) translate(-50%, -50%); }
    50% { transform: scale(1.05) translate(-50%, -50%); }
    100% { transform: scale(1) translate(-50%, -50%); }
  }




  /* Splash Screen Styling */
#splashScreen {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(-45deg, #1abc9c, #2c3e50, #16a085, #34495e);
  background-size: 400% 400%;
  animation: gradientAnimation 15s ease infinite;
  z-index: 10000;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  color: white;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  text-align: center;
}

@keyframes gradientAnimation {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

.splash-logo {
  width: 120px;
  height: 120px;
  margin-bottom: 20px;
  animation: fadeIn 1.2s ease;
  border-radius: 20px;
  box-shadow: 0 4px 20px rgba(255, 255, 255, 0.3);
}

.splash-content h1 {
  font-size: 3rem;
  margin-bottom: 10px;
  animation: fadeIn 1.5s ease;
}

.splash-content p {
  font-size: 1.3rem;
  margin-bottom: 30px;
  animation: fadeIn 2s ease;
}

.start-btn {
  padding: 14px 32px;
  font-size: 1.2rem;
  font-weight: bold;
  background-color: #ffffff;
  color: #1abc9c;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: background-color 0.3s ease;
  animation: fadeIn 2.5s ease;
}

.start-btn:hover {
  background-color: #ecf0f1;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}


  </style>
</head>
<body>
  <div id="splashScreen">
  <div class="splash-content">
    <img src="/static/logo.png" alt="DocuSmart Logo" class="splash-logo" />
    <h1>Welcome to DocuSmart</h1>
    <p>Your Smart Document Summarizer</p>
    <button onclick="hideSplash()" class="start-btn">Let‚Äôs Go üöÄ</button>
    <audio id="startSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_1fa359b5cd.mp3?filename=pop-94319.mp3"></audio>
  </div>
</div>

  <header>
    <span>DocuSmart - Smart Document Scanner & Summarizer</span>
    <div>
      <a href="/metrics" style="color: #ecf0f1; font-size: 16px; text-decoration: none; background-color: #1abc9c; padding: 8px 16px; border-radius: 5px; margin-right: 10px;">üìä View Metrics</a>
      <a href="/static/chatbot.html" style="color: #ecf0f1; font-size: 16px; text-decoration: none; background-color: #1abc9c; padding: 8px 16px; border-radius: 5px;">ü§ñ Try Chatbot</a>
    </div>
  </header>

  <section class="intro-section">
    <div class="intro-text">
      <h2>Tired of scanning documents manually?</h2>
      <p>Say goodbye to tedious work. Upload your file and get a summarized version in seconds.</p>
      <a href="#upload-section">Click Here to Start</a>
    </div>
    <div class="intro-image">
      <img src="/static/hack.jpeg" alt="Document Scan">
    </div>
  </section>

  <section class="upload-section" id="upload-section">
    <h1>Multimodal Document Abstraction</h1>
    <input type="file" id="fileInput" accept="/" />

    <br />
    <button onclick="generateSummary()">Generate Summary</button>
    <div id="result"></div>
  </section>

  <!-- Feedback Modal -->
  <div id="feedbackModal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="closeModal()">&times;</span>
    <h3>Submit Feedback</h3>

    <label>Your Name (optional):</label><br>
    <input type="text" id="validatorName" placeholder="Your name" style="width:100%; padding:8px;"><br><br>

    <label>Original Summary:</label>
    <textarea id="originalSummary" readonly style="width:100%; height:80px;"></textarea><br><br>

    <label>How would you rate the summary?</label>
    <div style="font-size: 22px; margin-bottom: 10px;">
      <span onclick="setRating(1)">‚≠ê</span>
      <span onclick="setRating(2)">‚≠ê</span>
      <span onclick="setRating(3)">‚≠ê</span>
      <span onclick="setRating(4)">‚≠ê</span>
      <span onclick="setRating(5)">‚≠ê</span>
    </div>

    <input type="hidden" id="ratingValue" value="0">

    <label>Additional Suggestions (optional):</label>
    <textarea id="suggestionBox" style="width:100%; height:60px;"></textarea><br><br>

    <button onclick="submitFeedback()">Submit Feedback</button>
    <p id="feedbackConfirmation" style="color: green; font-weight: bold; display: none;">Thank you for your feedback!</p>
  </div>
</div>
  <footer>
    &copy; 2025 DocuSmart. All rights reserved.
  </footer>

  <!-- JS Scripts -->
  <script>
  let selectedFile;
  let currentSummary = "";



  function hideSplash() {
    const splash = document.getElementById("splashScreen");
    const sound = document.getElementById("startSound");
    
    // Play sound
    if (sound) sound.play();

    // Fade out splash
    splash.style.transition = "opacity 1s ease";
    splash.style.opacity = 0;

    // Remove after fade-out
    setTimeout(() => splash.remove(), 1000);
  }
  function closeModal() {
    document.getElementById("feedbackModal").style.display = "none";
  }

  function openFeedback() {
    document.getElementById("originalSummary").value = currentSummary;
    document.getElementById("feedbackModal").style.display = "block";
  }

  async function generateSummary() {
    const fileInput = document.getElementById("fileInput");
    selectedFile = fileInput.files[0];
    const resultDiv = document.getElementById("result");

    if (!selectedFile) {
      alert("Please select a file.");
      return;
    }

    resultDiv.innerHTML = `<p><em>Generating summary, please wait...</em></p>`;

    const formData = new FormData();
    formData.append("file", selectedFile);

    try {
      const res = await fetch("/summarize/", { method: "POST", body: formData });

      const text = await res.text();
      let data;
      try {
        data = JSON.parse(text);
      } catch (e) {
        resultDiv.innerHTML = `<p style="color:red;">Error: Server returned invalid JSON.</p>`;
        console.error("Invalid JSON response:", text);
        return;
      }

      if (res.status !== 200 || data.error) {
        resultDiv.innerHTML = `<p style="color:red;">Error: ${data.error || 'Unknown error'}</p>`;
        return;
      }

      playCelebration();
      currentSummary = data.summary;

      resultDiv.innerHTML = `
        <h3>Summary of ${data.filename}</h3>
        <p><strong>Confidence:</strong> ${(data.confidence * 100).toFixed(1)}%</p>
        <textarea id="currentSummary" rows="7" style="width:100%;">${data.summary}</textarea>
        <br /><br />
        <button class="feedback-btn" onclick="openFeedback()">Give Feedback</button>
        <button class="feedback-btn" onclick="downloadPDF()">Download Summary</button>
      `;
    } catch (err) {
      resultDiv.innerHTML = `<p style="color:red;">Error: ${err.message}</p>`;
    }
  }

  function setRating(value) {
    document.getElementById("ratingValue").value = value;
    const stars = document.querySelectorAll("#feedbackModal span");
    stars.forEach((star, index) => {
      star.style.color = index < value ? "gold" : "#ccc";
    });
  }

  async function submitFeedback() {
    const rating = parseInt(document.getElementById("ratingValue").value);
    if (!rating || rating < 1 || rating > 5) {
      alert("Please select a rating between 1 and 5 stars.");
      return;
    }

    const payload = {
      filename: selectedFile ? selectedFile.name : "unknown",
      original_summary: document.getElementById("originalSummary").value,
      rating: rating,
      suggestion: document.getElementById("suggestionBox").value || "",
      validator: document.getElementById("validatorName").value || "Anonymous",
      timestamp: new Date().toISOString(),
      version: 2
    };

    const res = await fetch("/feedback/", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });

    const data = await res.json();
    closeModal();
    const confirm = document.getElementById("feedbackConfirmation");
    confirm.style.display = "block";
    setTimeout(() => confirm.style.display = "none", 5000);
  }

  function downloadPDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    const summary = document.getElementById("currentSummary").value;
    const lines = doc.splitTextToSize(summary, 180);
    doc.text("Summary", 10, 10);
    doc.text(lines, 10, 20);
    doc.save("summary.pdf");
  }

  function playCelebration() {
    const overlay = document.getElementById("celebrationOverlay");
    const confettiContainer = document.getElementById("confettiContainer");
    const butterflyContainer = document.getElementById("butterflyContainer");
    const sound = document.getElementById("popSound");

    overlay.style.display = "block";
    sound.play();

    for (let i = 0; i < 60; i++) {
      const confetti = document.createElement("div");
      confetti.className = "confetti-piece";
      confetti.style.left = Math.random() * 100 + "%";
      confetti.style.top = Math.random() * 100 + "%";
      confetti.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 70%)`;
      confetti.style.animationDelay = `${Math.random()}s`;
      confettiContainer.appendChild(confetti);
    }

    const butterflyImages = [
      "https://upload.wikimedia.org/wikipedia/commons/6/61/Butterfly_icon_purple.svg",
      "https://upload.wikimedia.org/wikipedia/commons/f/f8/Butterfly_icon.svg",
      "https://upload.wikimedia.org/wikipedia/commons/8/86/Butterfly_icon_yellow.svg",
      "https://upload.wikimedia.org/wikipedia/commons/f/fc/Butterfly_icon_blue.svg"
    ];

    for (let i = 0; i < 6; i++) {
      const butterfly = document.createElement("div");
      butterfly.className = "butterfly";
      butterfly.style.left = Math.random() * 90 + "%";
      butterfly.style.top = Math.random() * 80 + "%";
      butterfly.style.backgroundImage = `url(${butterflyImages[i % butterflyImages.length]})`;
      butterfly.style.animationDelay = `${Math.random()}s`;
      butterflyContainer.appendChild(butterfly);
    }

    setTimeout(() => {
      overlay.style.display = "none";
      confettiContainer.innerHTML = "";
      butterflyContainer.innerHTML = "";
    }, 4000);
  }
</script>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- üéâ Celebration Overlay -->
<div id="celebrationOverlay">
  <div id="confettiContainer"></div>
  <div id="butterflyContainer"></div>
  <div class="celebration-message">üéâ You saved 9 minutes of reading! üéâ</div>
</div>

<audio id="popSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_1fa359b5cd.mp3?filename=pop-94319.mp3"></audio>




</body>
</html>